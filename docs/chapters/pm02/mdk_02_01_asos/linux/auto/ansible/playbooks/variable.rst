Переменные
~~~~~~~~~~~

Ansible использует переменные для управления различиями между системами.  С помощью Ansible можно выполнять задачи в разных системах с помощью одной команды. 

Переменной может быть, например:

- информация об устройстве, которая собрана как факт, а затем используется в шаблоне.
- в переменные можно записывать полученный вывод команды.
- переменная может быть указана вручную в playbook

Имена переменных
"""""""""""""""""

В Ansible есть определенные ограничения по формату имен переменных:

- Переменные могут состоять из букв, чисел и символа _
- Переменные должны начинаться с буквы

Где можно определять переменные
""""""""""""""""""""""""""""""""
Переменные можно создавать:

- в инвентарном файле
- в playbook
- в специальных файлах для группы/устройства
- в отдельных файлах, которые добавляются в playbook через include (как в Jinja2)
- можно передавать переменные при вызове playbook

Также можно использовать факты, которые были собраны про устройство, как переменные.

Переменные в инвентарном файле
""""""""""""""""""""""""""""""
В инвентарном файле можно указывать переменные для группы:

::

  [br_net]
  192.168.0.1
  192.168.0.10
  
  [br_net:vars]
  dns = 10.10.10.10
  log_server = 192.168.0.2

Переменные **dns** и **log_server** можно применять в playbooks для всех устройств из группы **br_net**

Имена переменных в playbook заключаются в двойные фигурные скобки **{{dns}}**

Пример:
"""""""
Создать playbook для добавления dns сервера c IP адресом 10.10.10.10 на устройствах в сети br_net

::

    - name: Set DNS-server
      hosts: br_net
    
      tasks: 
        - name: insert line into resolv.conf
          ansible.builtin.lineinfile:
              path: /etc/resolv.conf
              line: nameserver {{dns}}
              state: present

В данном случае в файл /etc/resolv.conf будет добавлена строка nameserver 10.10.10.10. То есть вместо {{dns}} будет взято значение этой переменной, которые было описано в инвентарном файле.
  
